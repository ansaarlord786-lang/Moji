<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Emoji Generator</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
  <style>
    body { font-family: Arial, sans-serif; text-align: center; padding: 30px; }
    input, select, button { padding: 10px; margin: 10px; width: 250px; }
    .emoji-box { margin: 20px; display: inline-block; text-align: center; }
    img { max-width: 256px; border-radius: 20px; box-shadow: 0 0 10px #ccc; margin-top: 10px; }
    a { display: block; margin-top: 10px; text-decoration: none; color: white; background: #007BFF; padding: 8px 15px; border-radius: 8px; }
    a:hover { background: #0056b3; }
    #zipBtn { display: none; margin-top: 20px; }
  </style>
</head>
<body>
  <h1>üé® Emoji Generator (Gemini API)</h1>

  <input type="text" id="prompt" placeholder="Enter emoji prompt..." /><br>
  <input type="number" id="count" value="1" min="1" max="10" /><br>
  <select id="size">
    <option value="256">256 x 256 (Fast)</option>
    <option value="512">512 x 512 (Good)</option>
    <option value="1024" selected>1024 x 1024 (HD)</option>
  </select><br>
  <input type="text" id="prefix" placeholder="Custom filename prefix (optional)" /><br>
  
  <button onclick="generateEmojis()">Generate Emojis</button>
  <button id="zipBtn" onclick="downloadZip()">‚¨áÔ∏è Download All as ZIP</button>
  
  <div id="results"></div>

  <script>
    const API_KEY = "AIzaSyBgQp6Q7ekOaQ00n9VNWV6M17nZCrRRX7k"; // üîë Paste your Gemini API Key here
    let generatedImages = [];

    async function generateImage(prompt, width, height) {
      const response = await fetch(
        "https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash-latest:generateImage?key=" + API_KEY,
        {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({
            prompt: { text: prompt },
            size: { width: width, height: height }
          })
        }
      );

      const data = await response.json();
      if (data.candidates?.[0]?.content?.parts?.[0]?.inline_data?.data) {
        return "data:image/png;base64," + data.candidates[0].content.parts[0].inline_data.data;
      } else {
        throw new Error("No image returned from API");
      }
    }

    async function generateEmojis() {
      const prompt = document.getElementById("prompt").value;
      const count = parseInt(document.getElementById("count").value);
      const size = parseInt(document.getElementById("size").value);
      const prefix = document.getElementById("prefix").value.trim() || "emoji";
      const resultsDiv = document.getElementById("results");
      resultsDiv.innerHTML = "";
      generatedImages = [];

      for (let i = 0; i < count; i++) {
        const box = document.createElement("div");
        box.className = "emoji-box";
        box.innerHTML = `<p>Loading...</p>`;
        resultsDiv.appendChild(box);

        try {
          const imgSrc = await generateImage(prompt, size, size);
          const fileName = `${prefix}_${i+1}.png`;
          generatedImages.push({ src: imgSrc, name: fileName });

          box.innerHTML = `
            <img src="${imgSrc}" alt="Emoji" width="${size}" height="${size}" />
            <a href="${imgSrc}" download="${fileName}">‚¨áÔ∏è Download (${fileName})</a>
          `;
        } catch (e) {
          box.innerHTML = `<p style="color:red;">Error: ${e.message}</p>`;
        }
      }

      if (generatedImages.length > 0) {
        document.getElementById("zipBtn").style.display = "inline-block";
      }
    }

    async function downloadZip() {
      const zip = new JSZip();
      generatedImages.forEach((img) => {
        const base64Data = img.src.split(",")[1]; 
        zip.file(img.name, base64Data, { base64: true });
      });
      const content = await zip.generateAsync({ type: "blob" });
      saveAs(content, "emojis.zip");
    }
  </script>
</body>
</html>
